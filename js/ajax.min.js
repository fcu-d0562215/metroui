function _processData(t){_resetDataLayout(),$("#title").text(t.title),$("#paragraph").text(t.paragraph),$("#cover").attr("src",t.cover).height(.45*_height());var e=document.querySelector("#body #DataBody #_content");if(t.content){for(var n="",o="",a=0;a<Object.keys(t.content).length;a++)t.content[a].picture&&(o+="<img src="+t.content[a].picture+" style='margin-bottom:20px' width='70%' ><br>"),t.content[a].text&&(o+="<p>"+t.content[a].text+"</p><br>");e.innerHTML+='<div style="padding:10px 12% 0 12%">'+o+"</div>"}if(e=$("#body>#DataBody>div:nth-of-type(4)>div:first"),t.details){for(var a=0;a<Object.keys(t.details).length;a++)n+=Object.keys(t.details)[a]+" : "+t.details[Object.keys(t.details)[a]]+"<br>";e.before("<div class='col-md-4 col-lg-3 text-xs-left push-md-8 push-lg-9' style='margin-bottom:15px;'><div id='details' style='padding:10px 5px;'><span>"+n+"</span></div></div>")}return e=document.querySelector("#body>#DataBody>div:nth-of-type(4)"),t.lat&&(e.innerHTML+="<div class='col-md-4 col-lg-3 push-md-8 push-lg-9'><div style='padding: 0px 10px;'><p>地圖</p><p id='map' ></p></div></div>",$("#body #_content").addClass("col-md-8 col-lg-9 float-md-right pull-md-4 pull-lg-3"),initMap(t.lat,t.long)),_resize()}function _getData(t,e){void 0===e&&(e=0);var n=fullData[t].content[e];n&&_processData(n)&&(scrolltop(),history.state&&history.state.url!="?"+t+"&page="+e?history.pushState({response:$(".container-fluid").html(),type:t,page:e,url:"?"+t+"&page="+e},n.title,"?"+t+"&page="+e):history.replaceState({response:$(".container-fluid").html(),type:t,page:e,url:"?"+mode+"&page="+_GET.page},n.title,"?"+mode+"&page="+_GET.page))}function mainpage(){_resetMainLayout(),_processMain(),console.log("1"),history.state&&"?main"!=history.state.url?history.pushState({response:$(".container-fluid").html(),url:"?main"},"首頁","?main"):history.replaceState({response:$(".container-fluid").html(),url:"?main"},"首頁","?main")}function _processMain(t){"undefined"==t?_writeMain(t,fullData[t]):$.each(fullData,function(t,e){_writeMain(t,e)})}function _writeMain(t,e){for(console.log(t,e.contentMax),$("#"+t).html(""),i=e.contentNo;i<e.contentNo+contentSize;i++)if(e.content[i]){var n=e.content[i],o=n.title,a=n.cover,c=n.paragraph,l="_getData('"+t+"','"+content_no+"')",d='<div style="cursor:pointer;" class="mycard col-xs-12 col-sm-6 col-md-3 col-lg-2 col-xl-2" onclick="'+l+'"><p style="cursor:pointer;" class="mycard_title">'+o+'</p><img style="cursor:pointer;" src="'+a+'" alt=""><p style="cursor:pointer;" class="content">'+c+'</p><a style="cursor:pointer;" class="moreInfo" href onclick="event.preventDefault();">More info ...</a></div>';$("#"+t).append(d)}e.contentNo+contentSize>e.contentMax?$("#next"+t).remove():$("#next"+t).html()||$("#"+t+"Content").append("<span id='next"+t+"' onclick='mainNextContent("+t+")'>></span>"),e.contentNo<=0?$("#prev"+t).remove():$("#prev"+t).html()||$("#"+t+"Content").append("<span id='prev"+t+"' onclick='mainPrevContent("+t+")'><</span>")}function mainNextContent(t){fullData[t.id].contentNo!=fullData[t.id].contentMax&&fullData[t.id].contentNo<=fullData[t.id].contentMax-contentSize&&(fullData[t.id].contentNo+=contentSize,fullData[t.id].contentNo>fullData[t.id].contentMax-contentSize&&$("#next"+t.id).remove(),_processMain(t),0!=fullData[t.id].contentNo&&($("#prev"+t.id).html()||$("#"+t.id+"Content").prepend('<span id="prev'+t.id+'" onclick="mainPrevContent('+t.id+')"><</span>')))}function mainPrevContent(t){0!=fullData[t.id].contentNo&&(fullData[t.id].contentNo-=contentSize,fullData[t.id].contentNo<0&&(fullData[t.id].contentNo=0),_processMain(t),fullData[t.id].contentNo<=0&&$("#prev"+t.id).remove(),fullData[t.id].contentNo!=fullData[t.id].contentMax-contentSize&&($("#next"+t.id).html()||$("#"+t.id+"Content").append("<span id='next"+t.id+"' onclick='mainNextContent("+t.id+")'>></span>")))}function mainSwipeStart(){e=this.event,swipestart=e.touches[0].clientX}function mainSwipeEnd(t){e=this.event,(swipestart-e.changedTouches[0].clientX>=50||swipestart-e.changedTouches[0].clientX<=-50)&&(swipestart>e.changedTouches[0].clientX?mainNextContent(t):mainPrevContent(t))}function _resize(){return _changecontentSize(),_processMain(),!0}function _changecontentSize(){var t=_width();contentSize=t<576?1:t<768?2:t<992?3:t<1200?4:5}function scrolltop(){$(document).scrollTop(0)}function _width(){return window.innerWidth||document.documentElement.clientWidth||document.getElementsByTagName("body")[0].clientWidth}function _height(){return window.innerHeight||document.documentElement.clientHeight||document.getElementsByTagName("body")[0].clientHeight}function _GETURL(){URL=window.location.href.split("?"),URL.shift(),URL.length>0&&""!=URL[URL.length-1]&&(URL=URL.shift().split("&"),mode=URL.shift(),URL.forEach(function(t){var e=t.split("=");_GET[e[0]]=e[1]}))}function initMap(t,e){var n={lat:t,lng:e},o=new google.maps.Map(document.getElementById("map"),{zoom:17,center:n});new google.maps.Marker({position:n,map:o})}function _getFullData(){$.each(fullData,function(t,e){$.ajax({url:e.url,method:"GET",dataType:"json"}).done(function(t){e.content=t,e.contentMax=Object.keys(t).length-1}).fail(function(){}).always(function(){})})}function _resetDataLayout(){$("#body").remove(),$(".container-fluid").append('<div id="body"><div id="DataBody"><div class="row"><img id="cover" src="" width="100%" height="100%"></div><div class="row" style="padding-top:20px;padding-bottom:20px; "><span id="title" style="border-bottom:3px solid;"></span></div><div class="row"><h2 id="paragraph" ></h2></div><div class="row"><div id="_content" style="margin-bottom:15px" ></div></div></div></div>')}function _resetMainLayout(){$("#body").remove(),$(".container-fluid").append('<div class="row" id="body"><div class="col-xs-12"><div id="frame" class="col-xs-12"><p>ROAD TO FUTURE</p></div></div><div class="calouse col-xs-12"><a id="calouse_Header" href="">Food</a><div class="col-xs-12" style="padding:0"><div id="foodContent" class="calouse_Content"  ><div id="food" class="col-xs-12" ontouchstart="mainSwipeStart(food)" ontouchend="mainSwipeEnd(food)"></div><span id="nextfood" onclick="mainNextContent(food)">></span></div></div></div><div class="calouse col-xs-12"><a id="calouse_Header" href="">Travel</a><div id="travelContent" class="calouse_Content col-xs-12" ><div id="travel" class="col-xs-12" ontouchstart="mainSwipeStart(travel)" ontouchend="mainSwipeEnd(travel)" ></div><span id="nexttravel" onclick="mainNextContent(travel)">></span></div></div></div>'),_changecontentSize()}var URL,mode,_GET=[];_GETURL();var pageNo=0,pageMax=0,contentSize=0,types,swipestart,fullData={food:{url:"https://raw.githubusercontent.com/fcu-d0562215/wp-project/master/food.json",contentNo:0,contentMax:0,content:{}},travel:{url:"https://raw.githubusercontent.com/fcu-d0562215/wp-project/master/travel.json",contentNo:0,contentMax:0,content:{}}};$(window).resize(function(){_resize()}),$(document).ready(function(){$("ul.nav li.dropdown").hover(function(){$(this).find(".dropdown-menu").stop(!0,!0).delay(50).fadeIn(100),$(this).find("a").attr("aria-expanded","true"),$(this).addClass("open")},function(){$(this).find(".dropdown-menu").stop(!0,!0).delay(50).fadeOut(100),$(this).find("a").attr("aria-expanded","false"),$(this).removeClass("open")}),_getFullData()}),$.ajaxSetup({method:"POST",cache:!1,processData:!1,contentType:!1,beforeSend:function(t){$("#loading").stop().css("display","block").animate({opacity:1},1e3),$(".progress").stop().css({opacity:"1",display:"block"})},xhr:function(){var t=new window.XMLHttpRequest,e=0;return t.upload.addEventListener("progress",function(t){t.lengthComputable&&(e=t.loaded/t.total*20,console.log("  up "+e),$(".progress").attr("value",e))},!1),t.addEventListener("progress",function(t){t.lengthComputable&&(e=t.loaded/t.total*80+20,$(".progress").attr("value",e))},!1),t}}),$(document).ajaxStop(function(){"food"==mode||"travel"==mode?_getData(mode,_GET.page):mainpage()}),window.onpopstate=function(){event.state&&(console.log(event),$(".container-fluid").html(event.state.response),scrolltop())};